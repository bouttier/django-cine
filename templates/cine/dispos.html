{% extends "cine/cine.html" %}

{% block content %}
<h1>Disponibilités</h1>

<form method="post" action="{% url 'cine:dispos' %}">
    <button type="submit" class="btn">Modifier</button>
    {% csrf_token %}
    {% for dispo in dispos %}
        <div id="{{ dispo.soiree.date|date:"Y-m-d"}}">
            <h2>{{ dispo.soiree.date }}</h2>
            <div class="btn-group" data-toggle="buttons-radio">
                <button type="button" class="btn btn-primary btn-success{% if dispo.dispo == 'O' %} active{% endif %}" data-name="{{dispo.soiree.date|date:"Y-m-d"}},O">Présent</button>
                <button type="button" class="btn btn-primary btn-danger{% if dispo.dispo == 'P' %} active{% endif %}" data-name="{{dispo.soiree.date|date:"Y-m-d"}},P">Absent</button>
                <button type="button" class="btn btn-primary{% if dispo.dispo == 'N' %} active{% endif %}" data-name="{{dispo.soiree.date|date:"Y-m-d"}},N">Ne sais pas</button>
            </div>
            <dl>
                <dt>Catégorie</dt>
                <dd>{{ dispo.soiree.get_categorie }}</dd>
                <dt>Présents</dt>
                <dd> {{ dispo.soiree.presents }}</dd>
                <dt>Pas sûrs</dt>
                <dd> {{ dispo.soiree.pas_surs }}</dd>
            </dl>
        </div>
    {% endfor %}
    <div id="realform">
        {% for dispo in dispos %}
            <input type="hidden" name="{{ dispo.soiree.date|date:"Y-m-d" }}" value="{{ dispo.dispo }}" />
        {% endfor %}
    </div>
</form>

{% endblock %}

{% block scripts_jquery %}
    <script>
        $('.nav-tabs').button()
        $(function () {
            $('div.btn-group button[data-name]').on('click', function() {
                var select = $(this).data('name').split(',');
                $('#realform > input[name="'+select[0]+'"]').attr('value', select[1]);
            });
        });
    </script>
{% endblock %}
